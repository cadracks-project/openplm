

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.7.1. files.deletable – Module to get files to delete &mdash; openPLM 2.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="openPLM 2.0.1 documentation" href="../../../index.html" />
    <link rel="up" title="5.7. files" href="../files.html" />
    <link rel="next" title="5.7.2. files.formats — Simple module to test if a file is a CAD file" href="formats.html" />
    <link rel="prev" title="5.7. files" href="../files.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formats.html" title="5.7.2. files.formats — Simple module to test if a file is a CAD file"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../files.html" title="5.7. files"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">openPLM 2.0.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >6. Developer documentation</a> &raquo;</li>
          <li><a href="../../modules.html" >5. Modules (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">openPLM.plmapp</span></tt> package)</a> &raquo;</li>
          <li><a href="../files.html" accesskey="U">5.7. <tt class="docutils literal docutils literal docutils literal docutils literal"><span class="pre">files</span></tt></a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/logo_openplm.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="../files.html"
                        title="previous chapter">5.7. <tt class="docutils literal docutils literal docutils literal"><span class="pre">files</span></tt></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="formats.html"
                        title="next chapter">5.7.2. <tt class="docutils literal"><span class="pre">files.formats</span></tt> &#8212; Simple module to test if a file is a CAD file</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/devel/modules/files/deletable.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<div id='langselector'>
    <h3>Languages</h3>
    <ul>

    


    
    <li><a href="/docs/2.0.1/fr/devel/modules/files/deletable.html">Français</a></li>
    


</ul>
</div>

<div id="extlinks">
    <h3>External links</h3>
    <a href="http://openplm.org/trac/wiki">Wiki OpenPLM</a>
    <br/>
    <a href="http://openplm.org/trac/discussion/forum/1">Forum</a>
    <br/>
    <a href="http://openplm.org/trac/downloads">Download</a>
</div>

<div id="prevversions">
    <h3>Previous versions</h3>
    <a href="http://openplm.org/docs/1.2/index.html">1.2</a>
    <br/>
    <a href="http://openplm.org/docs/1.1/index.html">1.1</a>
</div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-plmapp.files.deletable">
<span id="files-deletable-module-to-get-files-to-delete"></span><h1>5.7.1. <tt class="xref py py-mod docutils literal"><span class="pre">files.deletable</span></tt> &#8211; Module to get files to delete<a class="headerlink" href="#module-plmapp.files.deletable" title="Permalink to this headline">¶</a></h1>
<p class="versionadded">
<span class="versionmodified">New in version 1.2.</span></p>
<p>Module to select which files should be deleted (physically removed) after:</p>
<blockquote>
<div><ul class="simple">
<li>a checkin of a <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a></li>
<li>a deletion of a <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a></li>
<li>a cancellation of a <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.Document" title="openPLM.plmapp.models.document.Document"><tt class="xref py py-class docutils literal"><span class="pre">Document</span></tt></a></li>
<li>a deprecation of a <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.Document" title="openPLM.plmapp.models.document.Document"><tt class="xref py py-class docutils literal"><span class="pre">Document</span></tt></a></li>
</ul>
</div></blockquote>
<p>Each case can have a different behaviour specified by:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#plmapp.files.deletable.ON_CHECKIN_SELECTORS" title="plmapp.files.deletable.ON_CHECKIN_SELECTORS"><tt class="xref py py-const docutils literal"><span class="pre">ON_CHECKIN_SELECTORS</span></tt></a></li>
<li><a class="reference internal" href="#plmapp.files.deletable.ON_DELETE_SELECTORS" title="plmapp.files.deletable.ON_DELETE_SELECTORS"><tt class="xref py py-const docutils literal"><span class="pre">ON_DELETE_SELECTORS</span></tt></a></li>
<li><a class="reference internal" href="#plmapp.files.deletable.ON_CANCEL_SELECTORS" title="plmapp.files.deletable.ON_CANCEL_SELECTORS"><tt class="xref py py-const docutils literal"><span class="pre">ON_CANCEL_SELECTORS</span></tt></a></li>
<li><a class="reference internal" href="#plmapp.files.deletable.ON_DEPRECATE_SELECTORS" title="plmapp.files.deletable.ON_DEPRECATE_SELECTORS"><tt class="xref py py-const docutils literal"><span class="pre">ON_DEPRECATE_SELECTORS</span></tt></a></li>
</ul>
</div></blockquote>
<p>These constants are lists of tuples (<em>test</em>, <em>selector</em>) where:</p>
<blockquote>
<div><ul class="simple">
<li><em>test</em> is a function that takes a <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a> and
returns True if <em>selector</em> applies to the given file</li>
<li><em>selector</em> is an instance of <tt class="xref py py-class docutils literal"><span class="pre">Selector</span></tt> which returns
a list of <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a> to be deleted.</li>
</ul>
</div></blockquote>
<p>They can be given to <a class="reference internal" href="#plmapp.files.deletable.get_deletable_files" title="plmapp.files.deletable.get_deletable_files"><tt class="xref py py-func docutils literal"><span class="pre">get_deletable_files()</span></tt></a> to retrieve the list of
<a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a> to delete.</p>
<dl class="class">
<dt id="plmapp.files.deletable.KeepLastNFiles">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">KeepLastNFiles</tt><big>(</big><em>count</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#KeepLastNFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.KeepLastNFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which keeps only the last <em>count</em> revisions
(last one include).</p>
</dd></dl>

<dl class="class">
<dt id="plmapp.files.deletable.KeepAllFiles">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">KeepAllFiles</tt><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#KeepAllFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.KeepAllFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which keeps all files: <tt class="xref py py-meth docutils literal"><span class="pre">get_deletable_files()</span></tt>
always returns an empty list.</p>
</dd></dl>

<dl class="class">
<dt id="plmapp.files.deletable.DeleteAllFiles">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">DeleteAllFiles</tt><big>(</big><em>include_last_revision=False</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#DeleteAllFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.DeleteAllFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which returns all undeleted files.</p>
<p>If <em>include_last_revision</em> is True, the given document file is also
included in the returned list.</p>
</dd></dl>

<dl class="class">
<dt id="plmapp.files.deletable.MaximumTotalSize">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">MaximumTotalSize</tt><big>(</big><em>max_size</em>, <em>order='revision'</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#MaximumTotalSize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.MaximumTotalSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which ensures that the size of files related to a revision 
does not exceed <em>max_size</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>max_size</strong> &#8211; maximum size in bytes</li>
<li><strong>order</strong> &#8211; ordering field used to select which files must be deleted
if the total size exceeds <em>max_size</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Possible values for <em>order</em> are:</p>
<blockquote>
<div><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">revision</span></tt></dt>
<dd>first deletes the most recent revisions</dd>
<dt><tt class="docutils literal"><span class="pre">-revision</span></tt></dt>
<dd>first deletes the oldest revisions</dd>
<dt><tt class="docutils literal"><span class="pre">size</span></tt></dt>
<dd>first deletes the biggest files</dd>
<dt><tt class="docutils literal"><span class="pre">-size</span></tt></dt>
<dd>first deletes the smallest files</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="plmapp.files.deletable.MaxPerDate">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">MaxPerDate</tt><big>(</big><em>frequency</em>, <em>maximum</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#MaxPerDate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.MaxPerDate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which keeps at most <em>maximum</em> per <em>frequency</em>
(<tt class="docutils literal"><span class="pre">day</span></tt>, <tt class="docutils literal"><span class="pre">month</span></tt>, <tt class="docutils literal"><span class="pre">year</span></tt>).</p>
<p>If the number of revisions exceeds <em>maximum</em>, most recent revisions
are first deleted.</p>
</dd></dl>

<dl class="class">
<dt id="plmapp.files.deletable.Modulo">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">Modulo</tt><big>(</big><em>number</em>, <em>modulo=1</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#Modulo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.Modulo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which only keeps revisions if the revision modulo <em>number</em> equals to
<em>modulo</em>.</p>
<p>For example, <tt class="docutils literal"><span class="pre">Modulo(4,</span> <span class="pre">1)</span></tt> keeps a revision of four, and the intial revision is
kept.</p>
</dd></dl>

<dl class="class">
<dt id="plmapp.files.deletable.YoungerThan">
<em class="property">class </em><tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">YoungerThan</tt><big>(</big><em>timedelta</em>, <em>incremental=True</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#YoungerThan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.YoungerThan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">plmapp.files.deletable.Selector</span></tt></p>
<p>A selector which deletes too frequent updates.</p>
<p>A revision is deleted if the difference between the date of creation of
the last revision and its creation time is lesser than <em>timedelta</em>
(a <a class="reference external" href="http://docs.python.org/2.6/library/datetime.html#datetime.timedelta" title="(in Python v2.6)"><tt class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></tt></a> object).</p>
<p>If <em>incremental</em> is True (the default), only the previous revision is tested.
This behaviour should be used after a checkin.</p>
</dd></dl>

<dl class="function">
<dt id="plmapp.files.deletable.pattern">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">pattern</tt><big>(</big><em>*patterns</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#pattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function which takes a <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a> and returns
True if its filename matches one of the given patterns (like <tt class="docutils literal"><span class="pre">*.txt</span></tt>).
patterns are not case sensitive.</p>
</dd></dl>

<dl class="function">
<dt id="plmapp.files.deletable.yes">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">yes</tt><big>(</big><em>x</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#yes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.yes" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple function that always returns True</p>
</dd></dl>

<dl class="function">
<dt id="plmapp.files.deletable.get_deletable_files">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">get_deletable_files</tt><big>(</big><em>doc_file</em>, <em>selectors</em><big>)</big><a class="reference internal" href="../../../_modules/plmapp/files/deletable.html#get_deletable_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plmapp.files.deletable.get_deletable_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of <a class="reference internal" href="../models.html#openPLM.plmapp.models.document.DocumentFile" title="openPLM.plmapp.models.document.DocumentFile"><tt class="xref py py-class docutils literal"><span class="pre">DocumentFile</span></tt></a> to delete.</p>
<p>Returns an empty list if <a class="reference internal" href="../../../admin/settings.html#settings.KEEP_ALL_FILES" title="settings.KEEP_ALL_FILES"><tt class="xref py py-const docutils literal"><span class="pre">settings.KEEP_ALL_FILES</span></tt></a> is True.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>doc_file</strong> &#8211; the last revision of the file</li>
<li><strong>selectors</strong> &#8211; list of tuples (<em>test</em>, <em>selector</em>) to determine which
selectors should be called</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="data">
<dt id="plmapp.files.deletable.ON_CHECKIN_SELECTORS">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">ON_CHECKIN_SELECTORS</tt><em class="property"> = [(&lt;function yes at 0xb833320&gt;, &lt;plmapp.files.deletable.KeepLastNFiles object at 0x84a2c50&gt;)]</em><a class="headerlink" href="#plmapp.files.deletable.ON_CHECKIN_SELECTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default selectors called after a checkin</p>
</dd></dl>

<dl class="data">
<dt id="plmapp.files.deletable.ON_DELETE_SELECTORS">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">ON_DELETE_SELECTORS</tt><em class="property"> = [(&lt;function yes at 0xb833320&gt;, &lt;plmapp.files.deletable.DeleteAllFiles object at 0x8494cd0&gt;)]</em><a class="headerlink" href="#plmapp.files.deletable.ON_DELETE_SELECTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default selectors called after a deletion</p>
</dd></dl>

<dl class="data">
<dt id="plmapp.files.deletable.ON_DEPRECATE_SELECTORS">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">ON_DEPRECATE_SELECTORS</tt><em class="property"> = [(&lt;function yes at 0xb833320&gt;, &lt;plmapp.files.deletable.DeleteAllFiles object at 0x8494410&gt;)]</em><a class="headerlink" href="#plmapp.files.deletable.ON_DEPRECATE_SELECTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default selectors called after a deprecation</p>
</dd></dl>

<dl class="data">
<dt id="plmapp.files.deletable.ON_CANCEL_SELECTORS">
<tt class="descclassname">plmapp.files.deletable.</tt><tt class="descname">ON_CANCEL_SELECTORS</tt><em class="property"> = [(&lt;function yes at 0xb833320&gt;, &lt;plmapp.files.deletable.DeleteAllFiles object at 0x84949d0&gt;)]</em><a class="headerlink" href="#plmapp.files.deletable.ON_CANCEL_SELECTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default selectors called after a cancellation</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formats.html" title="5.7.2. files.formats — Simple module to test if a file is a CAD file"
             >next</a> |</li>
        <li class="right" >
          <a href="../files.html" title="5.7. files"
             >previous</a> |</li>
        <li><a href="../../../index.html">openPLM 2.0.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >6. Developer documentation</a> &raquo;</li>
          <li><a href="../../modules.html" >5. Modules (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">openPLM.plmapp</span></tt> package)</a> &raquo;</li>
          <li><a href="../files.html" >5.7. <tt class="docutils literal docutils literal docutils literal docutils literal"><span class="pre">files</span></tt></a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2013, LinObject.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>